---
layout: post
title: "Retos básicos de Atenea - Hash (2)"
subtitle: "# WriteUp"
date: 2021-01-07 13:45:13 +0100
background: '/img/posts/06.jpg'
---



<h1 class="code-line" data-line-start=0 data-line-end=1 ><a id="Resolviendo_los_retos_bsicos_de_Atenea_CCNCERT_0"></a>Resolviendo los retos básicos de Atenea (CCN-CERT)</h1>
<p class="has-line-data" data-line-start="2" data-line-end="3">En un <a href="https://ch4m17ux.github.io/2021/01/06/retos-basicos-atenea.html">post anterior</a> estuve presentando la resolucion de los retos basicos de Atenea, en esta segunda entrega continuare con algunas retos mas, y quiza nos alcance para realizar una tercera entrega.</p>
<p class="has-line-data" data-line-start="4" data-line-end="5">Como en el post anterior, voy a eliminar los flags, para que os toméis el trabajo de leer la forma de solucionarlo, y por orden de la organización.</p>
<h2 class="code-line" data-line-start=6 data-line-end=7 ><a id="Reto_7__XOR_6"></a>Reto 7 – XOR</h2>
<h3 class="code-line" data-line-start=8 data-line-end=9 ><a id="Enunciado_8"></a><strong>Enunciado:</strong></h3>
<p class="has-line-data" data-line-start="10" data-line-end="11">Voy a copiar el enunciado que se tiene en la plataforma para poder comprender mejor lo que se nos pide:</p>
<blockquote>
<p class="has-line-data" data-line-start="12" data-line-end="13">Una cadena de texto puede ser cifrada aplicando el operador de bit XOR sobre cada uno de los caracteres utilizando una clave. Para descifrar la salida, sólo hay que volver a aplicar el operador XOR con la misma clave.</p>
</blockquote>
<p class="has-line-data" data-line-start="14" data-line-end="15">Debemos utilizar la clave <strong>encryptXOR</strong></p>
<p class="has-line-data" data-line-start="16" data-line-end="17">Para descifrar el siguiente mensaje:</p>
<p class="has-line-data" data-line-start="18" data-line-end="19"><strong>UGFzc3dvcmQ6IHhvFzYMACEfBiAgIA==</strong></p>
<h3 class="code-line" data-line-start=20 data-line-end=21 ><a id="Solucin_20"></a><strong>Solución:</strong></h3>
<p class="has-line-data" data-line-start="22" data-line-end="23">En este caso vemos que la contraseña a descifrar esta en <em><code>Base64</code></em>; asi que, debemos decodificarlo en este hash y posteriormente convertirlo a Hexadecimal.  La clave tambien la convertimos a hexadecimal y podemos utilizar una web que nos permita calcular bit a bit la respuesta. Para este reto utilizare la web <a href="http://xor.pw">XOR Calculator</a>.</p>
<div align="center"><p class="has-line-data" data-line-start="24" data-line-end="25"><img src="https://ch4m17ux.github.io/img/posts/reto-basico-atenea-2/basico-atenea-2-1.png" alt="Retos Básicos Atenea"></p></div>
<p class="has-line-data" data-line-start="26" data-line-end="27">Convertimos la respuesta de <em><code>Hex</code></em> a <em><code>ASCII</code></em>, y obtenemos:</p>
<div align="center"><p class="has-line-data" data-line-start="28" data-line-end="29"><img src="https://ch4m17ux.github.io/img/posts/reto-basico-atenea-2/basico-atenea-2-2.png" alt="Retos Básicos Atenea"></p></div>
<p class="has-line-data" data-line-start="30" data-line-end="31">También podríamos resolver este reto con un script de python:</p>
<div align="center"><p class="has-line-data" data-line-start="32" data-line-end="33"><img src="https://ch4m17ux.github.io/img/posts/reto-basico-atenea-2/basico-atenea-2-3.png" alt="Retos Básicos Atenea"></p></div>
<p class="has-line-data" data-line-start="34" data-line-end="35">Que nos da la misma respuesta que conseguimos con la web.  Finalmente, convertimos la respuesta en el formato de la flag:</p>
<div align="center"><p class="has-line-data" data-line-start="36" data-line-end="37"><img src="https://ch4m17ux.github.io/img/posts/reto-basico-atenea-2/basico-atenea-2-4.png" alt="Retos Básicos Atenea"></p></div>
<h2 class="code-line" data-line-start=37 data-line-end=38 ><a id="Reto_8__XOR_37"></a>Reto 8 – XOR</h2>
<h3 class="code-line" data-line-start=39 data-line-end=40 ><a id="Enunciado_39"></a><strong>Enunciado:</strong></h3>
<p class="has-line-data" data-line-start="40" data-line-end="41">Nos dan una serie de imágenes y nos piden que calculemos la entropía de cada uno de ellos, y la solución es el nombre del fichero con mayor entropía, incluyendo la extensión (<em>por ejemplo: imagen25.jpg</em>).</p>
<h3 class="code-line" data-line-start=42 data-line-end=43 ><a id="Solucin_42"></a><strong>Solución:</strong></h3>
<p class="has-line-data" data-line-start="44" data-line-end="45">Dentro de la explicación y las referencias que nos dan en el reto, podemos ver que hay un sitio donde encontramos un script en Python que nos calcula la entropía<a href="https://kennethghartman.com/calculate-file-entropy/"> [Aquí]</a>, así que lo tomaremos como base y haremos algunas modificaciones para que recorra el directorio, compare la entropía de cada fichero y nos muestre solo el que tenga la mayor.  Tambien que ese nombre lo convierta en el formato de la flag de la plataforma.</p>
<div align="center"><p class="has-line-data" data-line-start="46" data-line-end="47"><img src="https://ch4m17ux.github.io/img/posts/reto-basico-atenea-2/basico-atenea-2-5.png" alt="Retos Básicos Atenea"></p></div>
<div align="center"><p class="has-line-data" data-line-start="48" data-line-end="49"><img src="https://ch4m17ux.github.io/img/posts/reto-basico-atenea-2/basico-atenea-2-6.png" alt="Retos Básicos Atenea"></p></div>
<h2 class="code-line" data-line-start=49 data-line-end=50 ><a id="Reto_9__Magic_Number_49"></a>Reto 9 – Magic Number</h2>
<h3 class="code-line" data-line-start=51 data-line-end=52 ><a id="Enunciado_51"></a><strong>Enunciado:</strong></h3>
<p class="has-line-data" data-line-start="52" data-line-end="53">En esta ocasión nos dan un fichero sin extensión; debemos buscar cual es su &quot;<em><code>numero mágico</code></em>&quot; o &quot;<em><code>file signature</code></em>&quot;, expresado en mayúsculas.</p>
<h3 class="code-line" data-line-start=54 data-line-end=55 ><a id="Solucin_54"></a><strong>Solución:</strong></h3>
<p class="has-line-data" data-line-start="56" data-line-end="57">Para dar solución podemos hacer uso de la consola de linux y utilizar <strong><code>xxd</code></strong>, que nos da los números mágicos del fichero, también podemos hacer uso de <strong><code>file</code></strong>, para saber de que fichero se trata.</p>
<div align="center"><p class="has-line-data" data-line-start="58" data-line-end="59"><img src="https://ch4m17ux.github.io/img/posts/reto-basico-atenea-2/basico-atenea-2-7.png" alt="Retos Básicos Atenea"></p></div>

